<?xml version='1.0'?>
<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
<!ENTITY rfc2119 SYSTEM "http://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml">
<!ENTITY rfc3688 SYSTEM "http://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.3688.xml">
<!ENTITY rfc6020 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.6020.xml">
<!ENTITY rfc7950 SYSTEM "http://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7950.xml">
]>

<?rfc toc="yes"?>
<?rfc symrefs="yes"?>
<?rfc sortrefs="yes" ?>
<?rfc compact="yes"?>
<?rfc subcompact="no"?>
<?rfc linkmailto="no" ?>
<?rfc editing="no" ?>
<?rfc comments="yes" ?>
<?rfc inline="yes"?>
<?rfc rfcedstyle="yes"?>
<?rfc-ext allow-markup-in-artwork="yes" ?>
<?rfc-ext include-index="no" ?>
<!--<?rfc strict="no"?> -->

<rfc category="std"
     ipr="trust200902"
     docName="draft-ietf-anima-voucher-latest">
    <front>
        <title abbrev="Voucher and Revocation Profiles">Voucher and Voucher Revocation Profiles for Bootstrapping Protocols</title>
        <author initials="K.W." surname="Watsen" fullname="Kent Watsen">
            <organization>Juniper Networks</organization>
            <address>
                <email>kwatsen@juniper.net</email>
            </address>
        </author>
        <author fullname="Michael C. Richardson" initials="M." surname="Richardson">
          <organization abbrev="SSW">Sandelman Software Works</organization>
          <address>
            <email>mcr+ietf@sandelman.ca</email>
            <uri>http://www.sandelman.ca/</uri>
          </address>
        </author>
        <author initials="M.P." surname="Pritikin" fullname="Max Pritikin">
            <organization>Cisco Systems</organization>
            <address>
                <email>pritikin@cisco.com</email>
            </address>
        </author>
        <author initials="T.E." surname="Eckert" fullname="Toerless Eckert">
            <address>
                <email>tte+anima@cs.fau.de</email>
            </address>
        </author>

        <date/>
        <area>Operations</area>
        <workgroup>ANIMA Working Group</workgroup>
        <keyword>voucher</keyword>
        <abstract>
            <t>This memo defines the two artifacts "voucher" and "voucher-revocation",
            which are YANG-defined structures that have been signed by a TBD algorithm.</t>

            <t>The voucher artifact is generated by the device's manufacture or delegate.
            The voucher's purpose is to securely assign one or more devices to an owner.
            The voucher informs each device which entity it should consider to be its
            owner.</t>

            <t>The voucher revocation artifact is used by the manufacturer or delegate (i.e.
            the issuer of the voucher) to revoke vouchers, if ever necessary.  The
            voucher revocation format defined herein supports both issuer-wide and 
            voucher-specific constructs, enabling usage flexibility.</t>

            <t>For both artifacts, this memo only defines the artifact, leaving it
            to future work to describe specialized protocols for accessing them.</t>
        </abstract>
<!--
        <note title="Editorial Note (To be removed by RFC Editor)">
          <t>This draft contains many placeholder values that need to be replaced
          with finalized values at the time of publication.  This note summarizes
          all of the substitutions that are needed.  Please note that no other
          RFC Editor instructions are specified anywhere else in this document.</t>
          <t>This document contains references to other drafts in progress, both in
          the Normative References section, as well as in body text throughout.
          Please update the following references to reflect their final RFC assignments:
            <list style="symbols">
              <t>...</t>
            </list>
          </t>
          <t>Artwork in this document contains shorthand references to drafts in
          progress.  Please apply the following replacements:
            <list  style="symbols">
              <t><spanx style="verb">XXXX</spanx>  -&gt; the assigned RFC value for this draft</t>
            </list>
          </t>
          <t>Artwork in this document contains placeholder values for the date of publication of this document.  Please apply the following replacement:
            <list  style="symbols">
              <t><spanx style="verb">YYYY-MM-DD</spanx>  -&gt; the publication date of this draft</t>
            </list>
          </t>
          <t>The following one Appendix section is to be removed prior to publication:
            <list  style="symbols">
              <t>Appendix A.  Change Log</t>
            </list>
          </t>
        </note>
-->
    </front>

    <middle>
      <section title="Introduction" anchor="introduction">

        <t>This document defines a strategy to securely assign devices to an owner, using
        an artifact signed, directly or indirectly, by the device's manufacturer.
        This artifact is known as the voucher.</t>

        <t>A voucher may be useful in several contexts, but the driving
        motivation herein is to support secure bootstrapping mechanisms. This
        memo only defines the voucher artifact, leaving it to other work such as 
        <xref target="draft-ietf-netconf-zerotouch"/> and
        <xref target="draft-ietf-anima-bootstrapping-keyinfra"/> to describe 
        specialized protocols for accessing and distributing them.  Assigning
        ownership is important to bootstrapping mechanisms so that the booting
        device can authenticate the network that's trying to take control of it.</t>

        <t>The lifetimes of vouchers may vary.  In some bootstrapping protocols
        the vouchers may be ephemeral, whereas in others the vouchers may be 
        potentially long-lived.  In order to support the second category of vouchers,
        this document also defines a voucher revocation artifact, enabling the
        manufacturer or delegate to communicate the validity of its vouchers.</t>

        <t>This document uses YANG <xref target="RFC7950"/> to define the voucher
        and voucher revocation formats.  YANG is a data modeling language with
        established mappings to XML and JSON, with mappings to other encodings
        in progress.  Which encodings a particular solution uses is outside the
        scope of this document.</t>
        
        <t>This document uses <xref target="draft-ietf-anima-bootstrapping-keyinfra"/> 
        terminology. The device is known as a "Pledge", which communicates with 
        the "Registrar" of the owner's network, and the voucher is provided by the
        Manufacturer Authorized Signing Authority (MASA).</t> 

        <section title="Secure Imprinting using Vouchers">
            <t>A voucher is a cryptographically protected statement to the Pledge
                device indicating authorizing a zero-touch "imprint" on the Registrar
                domain. The voucher imparts the following information to
                the Pledge:</t>
            
            <t><list style="hanging">
                <t hangText="Assertion Basis:">Indicates the method that protects
                    the imprint (this is distinct from the voucher signature that 
                    protects the voucher itself). This might include manufacturer 
                    asserted ownership verification, assured logging operations or 
                    reliance on Pledge endpoint behavior such as secure root of trust 
                    of measurement. Only some methods are normatively defined in this 
                    document. Other methods are left for future work.</t>
                
                <t hangText="Registrar Authentication:">Indicates how the Pledge
                    can authenticate the Registrar. This might include an indication
                    of the private PKIX trust anchor used by the Registrar, or an indication
                    of a public PKIX trust anchor and additional CN-ID or DNS-ID
                    information to complete authentication. Symetric key or other
                    methods are left for future work.</t>
                
                <t hangText="Anti-Replay Protections:">Time or nonce based
                    information to constrain the voucher to time periods or bootstrap
                    attempts.</t>
            </list></t>
            
            <t>A number of boostrapping scenarios can be met using differing
                combinations of this information. All scenarios address the primary
                threat of a MiTM Registrar gaining control over the Pledge device. The
                following combinations are referred to within this document by
                name. Colloqually these are "types" of vouchers:</t>
            
            <figure>
                <artwork><![CDATA[
             |Assertion   |Registrar ID    | Validity    |
Voucher      |Log-|Veri-  |Trust  |CN-ID or| RTC | Nonce |
Name         | ged|  fied |Anchor |DNS-ID  |     |       |
---------------------------------------------------------|
Audit        |  X |       | X     |        |     | X     |
-------------|----|-------|-------|--------|-----|-------|
Nonceless    |  X |       | X     |        | X   |       |
Audit        |    |       |       |        |     |       |
-------------|----|-------|-------|--------|-----|-------|
Owner Audit  |  X |   X   | X     |        | X   | X     |
-------------|----|-------|-------|--------|-----|-------|
Owner ID     |    |   X   | X     |  X     | X   |       |
-------------|----|-------|----------------|-----|-------|
Bearer       |  X |       |   wildcard     | optional    |
-------------|----|-------|----------------|-------------|

  NOTE: All voucher types include a 'Pledge ID serial number'
        (Not shown for space reasons)
                ]]></artwork>
            </figure>
            
            <t><list style="hanging">
                <t hangText="Audit Voucher:">An Audit Voucher is named after the
                    logging assertion mechanisms that the Registrar then "audits" to
                    enforce local policy. The Registrar mitigates a MiTM Registrar by
                    auditing that an unknown MiTM registrar does not appear in the log
                    entries. This does not direct prevent the MiTM but provides a
                    response mechanism that ensures the MiTM is unsuccessful. This
                    advantage is that actual ownership knowledge is not required on
                    the MASA service.</t>
                
                <t hangText="Nonceless Audit Voucher:">An Audit Voucher without a
                    validity period statement. Fundamentally the same as an Audit
                    Voucher except that it can be issued in advance to support network
                    partions or to provide a permanent voucher for remote
                    deployments.</t>
                
                <t hangText="Ownership Audit Voucher:">An Audit Voucher where the
                    MASA service has verified the Registrar as the authorized owner.
                    The MASA service mitigates a MiTM Registrar by refusing to
                    generate Audit Voucher's for unauthorized Registrars. The
                    Registrar uses audit techniques to suppliment the MASA. This
                    provides an ideal sharing of policy decisions and enforcement
                    between the vendor and the owner.</t>
                
                <t hangText="Ownership ID Voucher:">An Ownership ID Voucher is
                    named after inclusion of the Pledge's CN-ID or DNS-ID within the
                    voucher. An example Ownership Voucher is defined in <xref target="draft-ietf-netconf-zerotouch"/>. The MASA service
                    mitigates a MiTM Registrar by identifying the specific Registrar
                    authorized to own the Pledge.</t>
                
                <t hangText="Bearer Voucher:">A Bearer Voucher is named after the
                    inclusion of a Registrar ID wildcard. Because the Registrar identity 
                    is not indicated this voucher type must be treated as a
                    secret and protected from exposure as any 'bearer' of the voucher
                    can claim the Pledge device. Publishing a nonceless
                    bearer voucher effectively turns the specified Pledge into a
                    "TOFU" device with minimal mitigation against MiTM Registrars.</t>

            </list></t> 
            <t>[[EDNOTE: Exact definitions of Assertion, ID and Validity
            methods come from the voucher document. Included are normative
            statements on how Registrar and Pledge operate on these informations
                after verifying the voucher]]</t>
        </section> <!-- end Imprint using Voucher -->
      </section>  <!-- end Introduction --> 

      <section title="Requirements Language">
        <t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL",
        "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY",
        and "OPTIONAL" in the sections below are to be interpreted
        as described in RFC 2119 <xref target="RFC2119"/>.</t>
      </section>

      <section title="Tree Diagram Notation" anchor="tree-diagram">
        <t>The meaning of the symbols in the above diagram is as follows:
          <list style="symbols">
            <t>Brackets "[" and "]" enclose list keys.</t>
            <t>Braces "{" and "}" enclose feature names, and indicate
            that the named feature must be present for the subtree
            to be present.</t>
            <t>Abbreviations before data node names: "rw" (read-write)
            represents configuration data and "ro" (read-only)
            represents state data.</t>
            <t>Symbols after data node names: "?" means an optional
            node, "!" means a presence container, and "*" denotes a
            list and leaf-list.</t>
            <t>Parentheses enclose choice and case nodes, and case
            nodes are also marked with a colon (":").</t>
            <t>Ellipsis ("...") stands for contents of subtrees that
            are not shown.</t>
          </list>
        </t>
      </section>

      <section title="Voucher" anchor="voucher">

        <t>The voucher is generated by the device's manufacture or delegate. 
        The voucher's purpose is to securely assign one or
        more devices to an owner.  The voucher informs each device which
        entity it should consider to be its owner.</t>

        <t>The voucher is signed by the device's manufacturer or delegate.
        NOTE: AT THIS TIME, THE SIGNING STRATEGY HAS NOT BEEN SELECTED.</t>

        <section title="Tree Diagram" anchor="voucher-tree-diagram">

          <t>Following is the tree diagram for the YANG module specified in 
          <xref target="voucher-yang-module"/>.  Details regarding each
          node in the tree diagram are provided in the YANG module.
          Please see <xref target="tree-diagram"/> for information
          on tree diagram notation.</t>

          <figure>
            <artwork><![CDATA[
INSERT_TEXT_FROM_FILE(refs/ietf-voucher-tree.txt)
]]></artwork>
          </figure>
        </section>  <!-- overview -->

        <section title="Examples" anchor="voucher-examples">

          <t>The following illustrates an ephemeral voucher encoded in JSON:</t>
          <figure>
            <artwork><![CDATA[
INSERT_TEXT_FROM_FILE(refs/ex-file-voucher.json)
]]></artwork>
          </figure>

          <t>The following illustrates a long-lived voucher encoded in XML:</t>
          <figure>
            <artwork><![CDATA[
INSERT_TEXT_FROM_FILE(refs/ex-file-voucher.xml)
]]></artwork>
          </figure>

        </section>  <!-- examples -->

        <section title="YANG Module" anchor="voucher-yang-module">

          <figure>
            <artwork><![CDATA[
<CODE BEGINS> file "ietf-voucher@YYYY-MM-DD.yang"

INSERT_TEXT_FROM_FILE(ietf-voucher@YYYY-MM-DD.yang)

<CODE ENDS>

]]></artwork>
          </figure>

        </section>  <!-- yang module -->

      </section>  <!-- voucher -->


      <section title="Voucher Revocation" anchor="voucher-revocation">

        <t>The vouchers revocation artifact is used to verify the revocation status
        of vouchers.  Voucher revocations are signed by the manufacturer or delegate
        (i.e. the issuer of the voucher).  Vouchers revocation statements MAY be
        verified by devices during the bootstrapping process, or at any time before
        or after by any entity (e.g., registrar or equivalent) as needed.
        Registrars or equivalent SHOULD verify voucher revocation statements
        and make policy decisions in case devices are not doing so themselves.</t>

        <t>Revocations are generally needed when it is critical
        for devices to know that assurances implied at the time the voucher was
        signed are still valid at the time the voucher is being processed.</t>

        <t>As mentioned in <xref target="introduction"/>, the lifetimes of vouchers
        may vary.  In some bootstrapping protocols the vouchers may be ephemeral,
        whereas in others the vouchers may be potentially long-lived.  For
        bootstrapping protocols that support ephemeral vouchers, there is no
        need to support revocations.  For bootstrapping protocols that support
        long-lived vouchers, the need to support revoking vouchers is a decision
        for each manufacturer.</t>

        <t>If revocations are not supported then voucher assignments are essentially
        forever, which may be acceptable for various kinds of devices. If revocations
        are supported, then it becomes possible to support various scenarios such as
        handling a key compromise or change in ownership.</t>

        <t>The voucher revocation format defined herein supports both issuer-wide
        (similar to a CRL) or voucher-specific (similar to an OCSP response)
        constructs, enabling usage flexibility.</t>

        <t>NOTE: AT THIS TIME, THE SIGNING STRATEGY HAS NOT BEEN SELECTED.</t>

        <section title="Tree Diagram" anchor="voucher-revocation-tree-diagram">

          <t>Following is the tree diagram for the YANG module specified in 
          <xref target="voucher-revocation-yang-module"/>.  Details
          regarding each node in the tree diagram are provided in the
          YANG module.  Please see <xref target="tree-diagram"/> for
          information on tree diagram notation.</t>

          <figure>
            <artwork><![CDATA[
INSERT_TEXT_FROM_FILE(refs/ietf-voucher-revocation-tree.txt)
]]></artwork>
          </figure>
        </section>  <!-- overview -->

        <section title="Examples" anchor="voucher-revocation-examples">

          <t>The following illustrates an issuer-wide voucher revocation in XML:</t>
          <figure>
            <artwork><![CDATA[
INSERT_TEXT_FROM_FILE(refs/ex-file-voucher-revocation.xml)
]]></artwork>
          </figure>

          <t>The following illustrates a voucher-specific revocation in JSON:</t>
          <figure>
            <artwork><![CDATA[
INSERT_TEXT_FROM_FILE(refs/ex-file-voucher-revocation.json)
]]></artwork>
          </figure>

        </section>  <!-- examples -->

        <section title="YANG Module" anchor="voucher-revocation-yang-module">

          <figure>
            <artwork><![CDATA[
<CODE BEGINS> file "ietf-voucher-revocation@YYYY-MM-DD.yang"

INSERT_TEXT_FROM_FILE(ietf-voucher-revocation@YYYY-MM-DD.yang)

<CODE ENDS>

]]></artwork>
          </figure>

        </section>  <!-- yang module -->
      </section>  <!-- voucher revocation -->


      <section title="Security Considerations" anchor="sec-con">
        <section title="Clock Sensitivity">
          <t>This document defines artifacts containing time values
          for voucher expirations and revocations, which
          require an accurate clock in order to be processed
          correctly.  Vendors planning on issuing vouchers with
          time values MUST ensure devices have an accurate clock when 
          shipped from manufacturing facilities,
          and take steps to prevent clock tampering.</t>
          <t>If it is not possible to ensure clock accuracy then 
          nonce based validity period vouchers should be used. Such
          implementations SHOULD assume that vouchers never
          expire and are not revokable.</t>
          <t>It is important to note that implementations SHOULD NOT
          rely on NTP for time, as it is not a secure protocol.</t>
        </section>
      </section>

      <section title="IANA Considerations" anchor="iana-considerations">

        <section title="The IETF XML Registry">
          <t>This document registers two URIs in the IETF XML
          registry <xref target="RFC3688"/>.  Following the format in
          <xref target="RFC3688"/>, the following registrations are
          requested:</t>
          <t>
            <figure>
                <artwork><![CDATA[
   URI: urn:ietf:params:xml:ns:yang:ietf-voucher
   Registrant Contact: The ANIMA WG of the IETF.
   XML: N/A, the requested URI is an XML namespace.

   URI: urn:ietf:params:xml:ns:yang:ietf-voucher-revocation
   Registrant Contact: The ANIMA WG of the IETF.
   XML: N/A, the requested URI is an XML namespace.
]]></artwork>
            </figure>
          </t>
        </section>

        <section title="The YANG Module Names Registry">
          <t>This document registers two YANG modules in the
          YANG Module Names registry <xref target="RFC6020"/>.
          Following the format defined in <xref target="RFC6020"/>, the
          the following registrations are requested:</t>
          <t>
            <figure>
                <artwork><![CDATA[
   name:         ietf-voucher
   namespace:    urn:ietf:params:xml:ns:yang:ietf-voucher
   prefix:       vch
   reference:    RFC XXXX

   name:         ietf-voucher-revocation
   namespace:    urn:ietf:params:xml:ns:yang:ietf-voucher-revocation
   prefix:       vchr
   reference:    RFC XXXX
]]></artwork>
          </figure>
        </t>
        </section>
      </section>

      <section title="Acknowledgements">
        <t>The authors would like to thank for following for
        lively discussions on list and in the halls (ordered
        by last name):
        </t>
      </section>

    </middle>

    <back>
        <references title="Normative References">
            &rfc2119;
            &rfc6020;
            &rfc7950;
        </references>

        <references title="Informative References">
            &rfc3688;

          <reference anchor='draft-ietf-netconf-zerotouch' target="https://tools.ietf.org/html/draft-ietf-netconf-zerotouch">
            <front>
              <title>Zero Touch Provisioning for NETCONF or RESTCONF based Management</title>
              <author initials='K.W.' surname='Watsen' fullname='Kent Watsen'>
                <organization>Cisco</organization>
              </author>
              <author initials='M.A.' surname='Abrahamsson' fullname='Mikael Abrahamsson'>
                <organization>T-Systems</organization>
              </author>
              <date year='2016' />
            </front>
            <seriesInfo name='Internet-Draft' value='draft-ietf-netconf-zerotouch'/>
          </reference>
          <reference anchor='draft-ietf-anima-bootstrapping-keyinfra' target="https://tools.ietf.org/html/draft-ietf-anima-bootstrapping-keyinfra">
            <front>
              <title>Bootstrapping Key Infrastructures</title>
              <author initials='M.P.' surname='Pritikin' fullname='Max Pritikin'>
                <organization>Cisco</organization>
              </author>
              <author initials='M.R.' surname='Richardson' fullname='Micheal Richardson'>
                <organization>Sandelman Software Works</organization>
              </author>
              <author initials='M.B.' surname='Behringer' fullname='Micheal Behringer'>
                <organization>Cisco</organization>
              </author>
              <author initials='S.B.' surname='Bjarnason' fullname='Steinthor Bjarnason'>
                <organization>Cisco</organization>
              </author>
              <date year='2016' />
            </front>
            <seriesInfo name='Internet-Draft' value='draft-ietf-anima-bootstrapping-keyinfra'/>
          </reference>
        </references>

        <section title="Change Log">
        </section>
    </back>
</rfc>

